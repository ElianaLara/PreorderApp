<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Place Your Order</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/preorder.css') }}">
</head>
<body>

<header class="top-bar">
  <a href="{{ url_for('main.home') }}" class="back">← Back</a>
  <h1>Place Your Order for {{ table.restaurant.name}}</h1>
  <p> {{ table.customer_name }} · {{ table.num_people }} · {{ table.preorders|length }} / {{ table.num_people }} ordered</p>
</header>

<main class="layout">

  <!-- MENU -->
  <section class="menu">
     <h2>Menu</h2>
        {% for category_name, subcategories in menu_items.items() %}
          <div class="category">
            <div class="category-header">
              {{ category_name }} <span class="toggle">+</span>
            </div>
            <div class="items">
              {% for subcat_name, items in subcategories.items() %}
                {% if items is mapping %}
                <!-- Nested subcategories (like Wines) -->
                <div class="subcategory">
                  <div class="subcategory-header">{{ subcat_name }} <span class="toggle">+</span></div>
                  <div class="items">
                    {% for nested_subcat_name, nested_items in items.items() %}
                    <div class="subcategory">
                      <div class="subcategory-header">{{ nested_subcat_name }} <span class="toggle">+</span></div>
                      <div class="items">
                        {% if nested_items %}
                          {% for item in nested_items %}
                          <div class="item"><h3>{{ item.name }}</h3>
                            <p>{{ item.description }}</p>
                            <button>Add</button>
                          </div>
                          {% endfor %}
                        {% else %}
                          <p>Coming soon</p>
                        {% endif %}
                      </div>
                    </div>
                    {% endfor %}
                  </div>
                </div>
                {% else %}
                <!-- Regular subcategories -->
                <div class="subcategory">
                  <div class="subcategory-header">{{ subcat_name }} <span class="toggle">+</span></div>
                  <div class="items">
                    {% if items %}
                      {% for item in items %}
                      <div class="item"><h3>{{ item.name }}</h3>
                        <p>{{ item.description }}</p>
                        <button>Add</button>
                      </div>
                      {% endfor %}
                    {% else %}
                      <p>Coming soon</p>
                    {% endif %}
                  </div>
                </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          {% endfor %}
</section>

  <!-- ORDER PANEL -->
  <aside class="order">
    <label>Your Name</label>
    <input type="text" placeholder="Enter your name">

    <h3>Your Items</h3>
    <p class="empty">No items added yet</p>

    <label>Notes:</label>
    <input type="text" placeholder="Example: Gluten Free">

    <button class="submit">Add Pre-Order</button>
  </aside>

</main>

<script src="{{ url_for('static', filename='js/preorder.js') }}"></script>

</body>
</html>
